name: "Address in attachment"
type: "query"
source: | 
  any(attachments,
      any(file.explode(.),
          any(.scan.strings.strings,
              regex.icontains(.,
                              '\d{1,5} .{0,20} (avenue|ave|drive|dr|road|rd|street|st|lane|ln|boulevard|blvd|way|circle|cir|court|ct|place|pl|terrace|ter|parkway|pkwy|alley|highway|hwy|expressway|expy|freeway|fwy|turnpike|tpke|crescent|cres|grove|square|sq|trail|trl)'
              )
          )
          or regex.icontains(.scan.ocr.raw,
                             '\d{1,5} .{0,20} (avenue|ave|drive|dr|road|rd|street|st|lane|ln|boulevard|blvd|way|circle|cir|court|ct|place|pl|terrace|ter|parkway|pkwy|alley|highway|hwy|expressway|expy|freeway|fwy|turnpike|tpke|crescent|cres|grove|square|sq|trail|trl)'
          )
      )
  )
severity: "low"
