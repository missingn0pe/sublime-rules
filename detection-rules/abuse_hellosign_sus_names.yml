name: "Service Abuse: HelloSign Share with Suspicious Sender or Document Name"
description: "The detection rule is intended to match on messages sent from HelloSign indicating a shared file to the recipient which contains suspicious content within the document or sender display name."
type: "rule"
severity: "medium"
source: "type.inbound\n\n// Legitimate Dropbox sending infratructure\nand sender.email.email == \"noreply@mail.hellosign.com\"\nand headers.auth_summary.spf.pass\nand headers.auth_summary.dmarc.pass\nand strings.ends_with(headers.auth_summary.spf.details.designator,\n                      '.hellosign.com'\n)\nand strings.icontains(subject.subject, ' - Signature Requested')\nand not strings.icontains(subject.subject, 'You just signed')\nand not strings.contains(body.current_thread.text, '@cdpesign.com') // negate CDP Esign which reuses hellosign\nand (\n  // contains the word dropbox\n  // the subject is in the format of \"<actor controlled title> - Signature Requeted by <actor controlled name>\"\n  strings.icontains(subject.subject, 'dropbox')\n  or strings.icontains(subject.subject, 'sharefile')\n  or strings.icontains(subject.subject, 'helloshare')\n\n  // sender names part of the subject\n  or (\n    // Billing Accounting\n    regex.icontains(subject.subject,\n                    ' - Signature Requested by .*Accounts? (?:Payable|Receivable)',\n                    ' - Signature Requested by .*Billing Support'\n    )\n\n    // HR/Payroll/Legal/etc\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*Compliance HR'\n    )\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*(?:Compliance|Executive|Finance|\\bHR\\b|Human Resources|\\bIT\\b|Legal|Payroll|Purchasing|Operations|Security|Training|Support).*(?:Department|Team)?'\n    )\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*Corporate Communications'\n    )\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*Employee Relations'\n    )\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*Office Manager'\n    )\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*Risk Management'\n    )\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*Payroll Admin(?:istrator)'\n    )\n\n    // IT related\n    or regex.icontains(subject.subject,\n                       ' - Signature Requested by .*IT Support',\n                       ' - Signature Requested by .*Information Technology',\n                       ' - Signature Requested by .*(?:Network|System)? Admin(?:istrator)',\n                       ' - Signature Requested by .*Help Desk',\n                       ' - Signature Requested by .*Tech(?:nical) Support'\n    )\n\n  )\n  // filename analysis\n  // the filename is also contianed in the subject line\n  or (\n    // scanner themed\n    regex.icontains(subject.subject, 'scanne[rd].* - Signature Requested by')\n    // image theme\n    or regex.icontains(subject.subject, '_IMG_.* - Signature Requested by')\n    or regex.icontains(subject.subject,\n                       'IMG[_-](?:\\d|\\W)+.* - Signature Requested by'\n    )\n\n\n    // Invoice Themes\n    or regex.icontains(subject.subject, 'Invoice.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'INV\\b.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Payment.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'ACH.* - Signature Requested by')\n    or regex.icontains(subject.subject,\n                       'Wire Confirmation.* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject,\n                       'P[O0]\\W+?\\d+\\\".* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject,\n                       'P[O0](?:\\W+?|\\d+).* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject, 'receipt.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Billing.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'statement.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Past Due.* - Signature Requested by')\n    or regex.icontains(subject.subject,\n                       'Remit(?:tance)?.* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject,\n                       'Purchase Order.* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject, 'Settlement.* - Signature Requested byt')\n\n    // contract language\n    or regex.icontains(subject.subject,\n                       'Pr[0o]p[0o]sal.* - Signature Requested by'\n    )\n\n    or regex.icontains(subject.subject, 'Claim Doc.* - Signature Requested by')\n\n    // Payroll/HR\n    or regex.icontains(subject.subject, 'Payroll.* - Signature Requested by')\n    or regex.icontains(subject.subject,\n                       'Employee Pay\\b.* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject, 'Salary.* - Signature Requested by')\n    or regex.icontains(subject.subject,\n                       'Benefit Enrollment.* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject, 'Employee Handbook.* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject, 'Reimbursement Approved.* - Signature Requested by'\n    )\n\n    // \n    // shared files/extenstion/urgency/CTA\n    or regex.icontains(subject.subject, 'Urgent.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Important.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Secure.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Encrypt.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'shared.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'protected.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Validate.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Action Required.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Final Notice.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Review(?: and| & |\\s+)?Sign.* - Signature Requested by')\n    or regex.icontains(subject.subject, 'Download PDF.* - Signature Requested by'\n    )\n\n    // all caps filename allowing for numbers, punct and spaces, and an optional file extenstion\n    or regex.contains(subject.subject,\n                      '[A-Z0-9[:punct:]\\s]+(?:\\.[a-zA-Z]{3,5}).* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject,\n                       '.*(?:shared|sent).* - Signature Requested by'\n    )\n\n    // MFA theme\n    or regex.icontains(subject.subject,\n                       'Verification Code.* - Signature Requested by'\n    )\n    or regex.icontains(subject.subject, '\\bMFA\\b.* - Signature Requested by')\n  )\n)\n"
attack_types:
  - "Callback Phishing"
  - "BEC/Fraud"
tactics_and_techniques:
  - "Evasion"
  - "Social engineering"
detection_methods:
  - "Sender analysis"
  - "Header analysis"
  - "Content analysis"
id: "464d98f3-38b4-5a72-b0d5-e3a148f88025"
testing_pr: 2085
testing_sha: c5c3b316db88d4643c37ce972e45032627cdd5c7
